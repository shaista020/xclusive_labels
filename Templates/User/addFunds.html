<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Add Funds-Volusion</title>
    {% load static %}
    <link rel="icon" type="image/x-icon" href="{% static 'images/images/logo1.png' %}" />
  
    <link rel="stylesheet" href="../../static/index.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link href="{% static 'bootstrap/bootstrap-5.2.2-dist/bootstrap-5.2.2-dist/css/bootstrap.min.css' %}" rel="stylesheet" />
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- Include jQuery -->

    
    <!-- Include navbar.js -->
    <style>
      main {
        margin: 3rem;
        @media (max-width: 730px) {
          margin: 1rem;
        }
      }
      #closeNav {
        @media (min-width: 993px) {
          display: none;
        }
      }
      .sidebar {
        @media (min-width: 993px) {
          height: 100vh;
          display: flex !important;
          flex-direction: column;
        }
      }
      .card {
        border: dashed 1.5px whitesmoke;
        padding: 50px;
        margin: 30px;
        width: auto;
      }
      input {
        margin-bottom: 20px;
      }

      @media (max-width: 768px) {
        .card {
          max-width: 500px;
        }
      }
      @media (max-width: 450px) {
        .card {
          max-width: 300px;
          margin: 20px;
          padding: 40px;
        }
      }
      .first-sec {
        display: flex;
        align-items: center;
        gap: 20px;
      }
      .second-sec {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        gap: 20px;
      }
      .toggle {
        margin: 10px;
      }
      .navbar {
        display: flex;
        justify-content: space-between;
        padding: 10px;
      }
      .add {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .form-control {
        display: block;
        width: 100%;
        padding: 0.75rem 0.75rem;
      }
      .form-select {
        display: block;
        width: 100%;
        padding: 0.75rem 2.25rem 0.75rem 0.75rem;
      }
    </style>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const brand = document.getElementById("brand");
        const closeNav = document.getElementById("closeNav");
        const mynav = document.getElementById("snavbarTogglerDemo03");

        if (brand) {
          brand.addEventListener("click", function () {
            if (mynav) {
              mynav.style.display = "block";
              mynav.style.height = "100vh";
            }
          });
        }

        if (closeNav) {
          closeNav.addEventListener("click", function () {
            mynav.style.display = "none";
          });
        }
      });

      document.addEventListener("click", function (event) {
        const mynav = document.getElementById("snavbarTogglerDemo03");
        const brand = document.getElementById("brand");

        if (
          mynav.style.display === "block" &&
          !mynav.contains(event.target) &&
          event.target !== brand
        ) {
          mynav.style.display = "none";
        }
      });

      document.addEventListener("DOMContentLoaded", function (event1) {
        document
          .getElementById("customizeBtn")
          .addEventListener("click", function () {
            document.getElementById("customizeMenu").style.display = "block";
            event.stopPropagation();
          });
      });
      document.addEventListener("click", function (event1) {
        if (
          customizeMenu.style.display == "block" &&
          !customizeMenu.contains(event.target) &&
          event.target !== customizeBtn
        ) {
          customizeMenu.style.display = "none";
        }
      });

      document.addEventListener("DOMContentLoaded", function (event2) {
        document.getElementById("nBtn").addEventListener("click", function () {
          document.getElementById("nMenu").style.display = "block";
          event.stopPropagation();
        });
      });
      document.addEventListener("click", function (event2) {
        if (
          nMenu.style.display == "block" &&
          !nMenu.contains(event.target) &&
          event.target !== nBtn
        ) {
          nMenu.style.display = "none";
        }
      });
    </script>
  </head>
  <body>
    <div class="row bigDiv">
      <!-- sidebar -->
      <div
        class="sidebar nav col-5 col-sm-4 col-md-3 col-xl-3 col-xxl-2 col-lg-3"
      >
        <div id="sidebar">
            {% include 'sidebar.html' %}
        </div>
      </div>
      <!-- Header -->
      <div class="col-sm-12 col-md-12 col-lg-9 col-xl-9 col-xxl-10">
        <div class="row">
          <div id="header" class="p-0">
            {% include 'navbar.html' %}
          </div>
        <main>
          <div class="container">
            <h2>Add Funds</h2>
          </div>

          <form
          id="fundForm"
          class="card"
          style="max-width: 100%; text-align: start; background-color: #fff; font-size: large;"
        >
          <div class="mb-3">
            <label for="Credit" class="form-label">Credit ($)</label>
            <input type="number" id="Credit" class="form-control" required />
          </div>
    
          <div class="mb-3">
            <label for="Payment_Method" class="form-label">Payment Method</label>
            <select id="Payment_Method" class="form-select">
              <option value="credit_debit_card">Credit/Debit Card (instantly)</option>
              <option value="crypto_currency">Crypto Currency (instantly)</option>
              <option value="venmo">Venmo (2-3 hours)</option>
              <option value="cashapp">CashApp (2-3 hours)</option>
              <option value="zelle">Zelle (2-3 hours)</option>
            </select>
          </div>
    
          <div class="text-start">
            <button
              type="submit"
              id="submitCourse"
              class="btn btn-dark"
              style="padding: 10px 20px;"
            >
              Submit
            </button>
          </div>
        </form>

        </main>
      </div>
    </div>
    <script src="../../static/index.js"></script>
    <script>
     
      function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
          const cookies = document.cookie.split(';');
          for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.startsWith(name + '=')) {
              cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
              break;
            }
          }
        }
        return cookieValue;
      }
  
      const csrfToken = getCookie('csrftoken');
  
      $(document).ready(function () {
        $("#fundForm").on("submit", function (e) {
          e.preventDefault(); 
          const courseData = {
            credit: $("#Credit").val(),
            payment_method: $("#Payment_Method").val(),
          };
  
          console.log("Sending data:", courseData);
  
          $.ajax({
            url: "/api/addfunds/",
            type: "POST",
            headers: {
              "Content-Type": "application/json",
              "X-CSRFToken": csrfToken,
            },
            data: JSON.stringify(courseData),
            success: function () {
              alert("Funds added successfully!!!");
              fetchtype(); 
              // $("#submitCourse").removeClass("editMode").text("Save Funds");
              $("#fundForm")[0].reset(); 
            },
            error: function (xhr, status, error) {
              console.error("Error response:", xhr.responseText); 
              alert("Failed to add funds.");
            },
          });
        });
      });
  
      function fetchtype() {
        console.log("Fetch function called."); 
      }
    </script>
  </body>
</html>

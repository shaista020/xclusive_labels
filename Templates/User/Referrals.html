<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Referrals-Volusion</title>
    {% load static %}
    <link rel="icon" type="image/x-icon" href="{% static 'images/images/logo1.png' %}" />

    <link rel="stylesheet" href="{% static 'index.css' %}" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <link href="{% static 'bootstrap/bootstrap-5.2.2-dist/bootstrap-5.2.2-dist/css/bootstrap.min.css' %}" rel="stylesheet" />
    <link rel="stylesheet" href="../../static/index.css" />

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/colreorder/1.3.0/css/colReorder.dataTables.min.css">
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
    
    <!-- colReorder JS -->
    <script src="https://cdn.datatables.net/colreorder/1.3.0/js/dataTables.colReorder.min.js"></script>
    
    <style>
      #cMenu {
 display: none; 
}
body {
        background-color: #f8f9fa;
      }

     .table {
       border-radius: 10px;
       overflow: hidden;
     }

     .table th,
     .table td {
       vertical-align: middle;
       padding: 15px;
       text-align: center;
     }

     .table thead {
       background-color: #343a40;
       color: white;
     }

     .headDiv {
       margin-left: 0px;
     }
     .heading {
       @media (max-width: 758px) {
         margin: 10px !important;
       }
     }
     .hidden {
       display: none;
     }
     /* Pagination Styles */
   
  
     label {
       text-align: left;
       margin-bottom: 5px;
     }
     input {
       margin-bottom: 20px;
     }
     select {
       margin-bottom: 20px;
     }
     .form-control {
       padding: 0.75rem 0.75rem;
     }
     .form-select {
       padding: 0.75rem 2.25rem 0.75rem 0.75rem;
     }
    

     .heading {
       @media (max-width: 758px) {
         margin: 10px !important;
       }
     }

     .form-group {
       margin-bottom: 15px;
     }
    

     .dropdown {
       position: relative;
       display: inline-block;
     }

     .dropdown-content {
       display: none;
       position: absolute;
       right: 20px;
       top: 30px;
       background-color: #f9f9f9;
       min-width: 120px;
       box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.2);
       z-index: 1;
     }

     .dropdown-content a {
       color: black;
       padding: 8px 12px;
       text-decoration: none;
       display: block;
     }

     .dropdown-content a:hover {
       background-color: #f1f1f1;
     }

     .dropdown:hover .dropdown-content {
       display: block;
     }

     .dropdown-btn {
       background-color: transparent;
       border: none;
       cursor: pointer;
       font-size: 20px;
     }
     .ship {
       margin: 2rem;
     }
     .ship:hover {
       background-color: white;
       font-size: large;
     }
     /* Earnings block alignment */
.earnings-left {
    text-align: right; /* Align text to the left */
    padding-left: 0; /* Remove any extra padding */
    margin-left: 0; /* Remove any extra margin */
}

/* Optional: Add space between text elements */
.earnings-left p,
.earnings-left h4 {
    margin-bottom: 10px; /* Add spacing between elements */
}

   </style>
    <script>
      document.addEventListener("DOMContentLoaded", function (event3) {
        const cBtn = document.getElementById("cBtn");
        var cMenu = document.getElementById("cMenu");

        cBtn.addEventListener("click", function (event3) {
          cMenu = document.getElementById("cMenu");
          cMenu.style.display = "block";
          event.stopPropagation();
        });

        document.querySelectorAll(".toggle-col").forEach(function (checkbox) {
          console.log("gfjgh");
          checkbox.addEventListener("change", function () {
            const colClass = this.getAttribute("data-col");
            const isVisible = this.checked;
            console.log("eee");

            document
              .querySelectorAll(
                "th:nth-child(" + colClass + "), td:nth-child(" + colClass + ")"
              )
              .forEach(function (cell) {
                cell.style.display = isVisible ? "" : "none";
              });
          });
        });
        document.addEventListener("click", function (event3) {
          if (
            cMenu.style.display == "block" &&
            !cMenu.contains(event.target) &&
            event.target !== cBtn
          ) {
            cMenu.style.display = "none";
          }
        });
      });

      document.addEventListener("DOMContentLoaded", function () {
        const tbody = document.getElementById("dataTableBody");
        const noDataImage = document.getElementById("no-data-image");

        // Check if tbody has any rows
        const hasData = tbody.querySelectorAll("td").length > 0;

        // Show or hide the table body and image based on data availability
        if (hasData) {
          tbody.style.display = "table-row-group";
          noDataImage.style.display = "none !important";
        } else {
          tbody.style.display = "none";
          noDataImage.style.display = "block";
        }
      });
    </script>
  </head>
  <body>
    <div class="row bigDiv">
      <!-- sidebar -->
      <div
        class="sidebar nav col-5 col-sm-4 col-md-3 col-xl-3 col-xxl-2 col-lg-3"
      >
        <div id="sidebar">{% include 'sidebar.html' %}</div>
      </div>
      <!-- Header -->
      <div class="col-sm-12 col-md-12 col-lg-9 col-xl-9 col-xxl-10">
        <div class="row">
          <div id="header" class="p-0">{% include 'navbar.html' %}</div>
        </div>
        <main style="margin: 1rem">
          <div style="margin-bottom: 50px" class="headDiv" id="packageDiv">
            <div class="heading m-5">
              <!-- Referrals Heading and Customize Columns Button -->
              <div class="row align-items-center mb-4">
                <h2 class="col-12 col-md-7">Referrals</h2>
                <div class="col-12 col-md-5 text-md-end mt-2 mt-md-0">
                  <button id="cBtn" class="btn btn-dark">
                    Customize Columns
                  </button>
                </div>
              </div>

              <!-- Referral Bonus Section -->
              <div class="p-3 bg-light rounded shadow-sm mb-4">
                <div class="d-flex align-items-center mb-2">
                  <img
                  src="{{'/media/images/referral-bonus.svg'}}"
                    alt="Referral Bonus"
                    class="me-2"
                    style="width: 24px; height: 24px"
                  />
                  <span class="fw-bold">Referral Bonus!</span>
                </div>
                <div class="row align-items-center">
                  <p class="col-12 col-md-9 mb-2 mb-md-0">
                    You will get 10% from every referral you made.
                  </p>
                 <!-- Button to trigger the modal -->
<div class="col-12 col-md-3 text-md-end">
  <button class="btn btn-dark w-100 w-md-auto" data-bs-toggle="modal" data-bs-target="#referralModal">
       Your Referral Link
  </button>
</div>

<!-- Modal -->
<div class="modal fade" id="referralModal" tabindex="-1" aria-labelledby="referralModalLabel" aria-hidden="true">
  <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
              <h5 class="modal-title" id="referralModalLabel">Your Referral Link</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body text-center">
              <p id="referralLink" class="mb-3">{{ referral_link }}</p>
              <button class="btn btn-outline-primary" onclick="copyReferralLink()">
                  <i class="bi bi-clipboard"></i> Copy Link
              </button>
          </div>
          <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
      </div>
  </div>
</div>

                </div>
              </div>

              <!-- Customize Columns Menu (Initially Hidden) -->
              <div
                id="cMenu"
                class="card p-3 position-absolute hidden"
                style="right: 30px; z-index: 1"
              >
                <div class="form-check">
                  <input
                    type="checkbox"
                    class="form-check-input toggle-col"
                    data-col="1"
                    id="nameCol"
                    checked
                  />
                  <label class="form-check-label" for="nameCol">Name</label>
                </div>
                <div class="form-check">
                  <input
                    type="checkbox"
                    class="form-check-input toggle-col"
                    data-col="2"
                    id="emailCol"
                    checked
                  />
                  <label class="form-check-label" for="emailCol">Email</label>
                </div>
                <div class="form-check">
                  <input
                    type="checkbox"
                    class="form-check-input toggle-col"
                    data-col="3"
                    id="withdrawCol"
                    checked
                  />
                  <label class="form-check-label" for="withdrawCol"
                    >Available for Withdraw</label
                  >
                </div>
                <div class="form-check">
                  <input
                    type="checkbox"
                    class="form-check-input toggle-col"
                    data-col="4"
                    id="joinedAtCol"
                    checked
                  />
                  <label class="form-check-label" for="joinedAtCol"
                    >Joined At</label
                  >
                </div>
              </div>
            </div>

            <div class="card mt-5">
              <div class="table-responsive">
                  <table class="table table-hover" id="user">
                      <thead>
                          <tr>
                              <th>Name</th>
                              <th>Email</th>
                              <th>Available for Withdraw</th>
                              <th>Joined At</th>
                          </tr>
                      </thead>
                      <tbody>
                          {% for referral in referrals %}
                              <tr>
                                  <td>{{ referral.username }}</td>
                                  <td>{{ referral.email }}</td>
                                  <td>{{ referral.available_for_withdraw }}</td>
                                  <td>{{ referral.joined_at }}</td>
                              </tr>
                          {% empty %}
                              <tr>
                                  <td colspan="4" class="text-center">No referrals available.</td>
                              </tr>
                          {% endfor %}
                      </tbody>
                  </table>
              </div>
              
              <div class="row mt-4">
                  <div class="col-12 col-md-12">
                      <div class="earnings-left">
                          <p>Personal Earnings: {{ user_own_commission }}</p>
                          <p>Referral Earnings: {{ referral_commission }}</p>
                          <h4>Total Earnings: {{ total_commission }}</h4>
                      </div>
                  </div>
              </div>
          </div>
          
          
          
          </div>
        </main>
      </div>
    </div>
    <script src="../../static/index.js"></script>
    <script>
   function copyReferralLink() {
    const referralElement = document.getElementById('referralLink');

    if (!referralElement) {
        console.error('Element with ID "referralLink" not found.');
        return;
    }

    const referralLink = referralElement.innerText;

    if (!navigator.clipboard || !navigator.clipboard.writeText) {
        console.error('Clipboard API is not supported.');
        alert('Your browser does not support the Clipboard API. Please copy manually.');
        return;
    }

    navigator.clipboard.writeText(referralLink).then(() => {
        alert('Referral link copied to clipboard!');
    }).catch(err => {
        console.error('Failed to copy text: ', err);
    });
}


 </script>
<script>
  $(document).ready(function () {
      console.log($.fn.dataTable.ColReorder ? "colReorder loaded" : "colReorder not loaded");

      $('#user').DataTable({
          colReorder: true, // Enable column reordering
          paging: true, // Enable pagination
          searching: true, // Enable search functionality
          ordering: true, // Enable column sorting
         
      });
  });
</script>
  </body>
</html>
